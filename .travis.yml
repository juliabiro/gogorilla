language: go
go:
  - "1.15.2"

dist: xenial
services:
  - xvfb

before_install:
- sudo apt-get install xorg-dev libgl1-mesa-dev libglfw3 libglfw3-dev


jobs:
  include:
    - stage: build
      script:
        go build main.go
    - stage: test
      # before_script:
      #   - "export DISPLAY=:99.0"
      #   - "sh -e /etc/init.d/xvfb start"
      #   - sleep 3 # give xvfb some time to start
      script: xvfb-run ; go test ./gorilla_test


